/**************************************************

 file: main.c
 purpose: simple demo that demonstrates the timer-function

 **************************************************/

#include <stdio.h>
#include <stdlib.h>

#include "Timer.h"

void timer_handler(int);

int var = 0;

int main(void) {
   boost::mutex io_mutex;
   boost::asio::io_service io_service;

   Timer timer(io_service,io_mutex);
   if (0
         != timer.start_timer(1000 /*time in ms */, 100 /* TimerId */,
               &timer_handler /* HandlerFunction */)) {
      printf("\n timer error\n");
      return (1);
   }
   if (0
         != timer.start_timer(3000 /*time in ms */, 101 /* TimerId */,
               &timer_handler /* HandlerFunction */)) {
      printf("\n timer error\n");
      return (1);
   }

   printf("\npress ctl-c to quit.\n");

   while (1) {
      if (var > 50) {
         break;
      }
   }

   timer.stop_timer();

   return (0);
}

void timer_handler(int arg) {
   printf("timer: var is %i\n       arg is %i", var++, arg);
}
