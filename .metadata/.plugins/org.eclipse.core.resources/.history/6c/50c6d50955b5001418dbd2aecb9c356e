/*
 * Switch.h
 *
 *  Created on: Jan 25, 2015
 *      Author: micha
 */

#ifndef SWITCH_H
#define SWITCH_H

#include <string>
#include <list>
#include <map>
#include <iostream>
#include "iSwitch.h"

typedef enum SwitchState {
   Unknown,
   Released,
   Pressed,
   ShortPressed,
   LongPressed,
   VeryLongPressed,
   Jammed
} SwitchState;

typedef int (*t_SwitchActionFunction)(/*int,int*/);
typedef std::map<SwitchState, t_SwitchActionFunction> ActionFunctionMap;

class Room;

class ISwitch {
   public:
      ISwitch() {
      }
      virtual ~ISwitch() {
      }
      // Port interface functions
      virtual void OnPress() = 0;
      virtual void OnRelease() = 0;

      // access functions
      virtual SwitchState getState() const = 0;
      virtual void addAction(const SwitchState& state,
            t_SwitchActionFunction Function) = 0;
};

class Switch: public ISwitch, public Base {
   public:
      // Constructors
      Switch(unsigned int Id, std::string Name, const Room* pRoom);
      Switch(const Switch &obj);          // copy constructor
      virtual ~Switch() {
      }

      // Operators
      Switch& operator=(Switch other);    // assignment operator

      // Port interface functions
      virtual void OnPress();
      virtual void OnRelease();

      // access functions
      virtual SwitchState getState() const {
         return _State;
      }
      virtual const Room* getRoom() const {
         return _pRoom;
      }
      virtual const ActionFunctionMap getActionMap() const {
         return _switchActionMap;
      }

      // construction functions
      virtual void addAction(const SwitchState& state, t_SwitchActionFunction Function);
   protected:
      Switch() :
            Base(0, ""), _State(Unknown), _pRoom(nullptr) {
         std::cout << "Wrong default constructor Switch";
      }
      SwitchState _State;
      const Room* _pRoom;
      ActionFunctionMap _switchActionMap;
};

#endif /* SWITCH_H */
